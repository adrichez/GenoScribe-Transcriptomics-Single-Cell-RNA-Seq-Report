---
title: "IPBLN Bioinformatics Report"

include-in-header:
  text: |
    <link rel="shortcut icon" href="../../../../01-images/icons/favicon.svg"/>
    <link rel="icon" type="image/x-icon" href="../../../../01-images/icons/favicon.ico">

params:
  project_path: ""
  experiment_name: ""
  report_version: ""
---


<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  CHATBOT
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->

```{=html}
<!-- Contenedor del chat -->
<div id="chat-container">
  <button id="chat-toggle"></button>
  <div id="chat-box">
    <div id="chat-info" class="chat-info">
      <h1>
        Mini Chat RAG (beta)
      </h1>

      <p>
        ¡Hola! Soy <strong>Geni</strong>, el asistente inteligente de <strong>GenoScribe</strong>.  
        Estoy aquí para ayudarte a explorar de forma interactiva el contenido de este informe bioinformático.
      </p>

      <p>
        Cuando me haces una pregunta, primero intento reconocer si coincide con alguno de los patrones o expresiones que conozco.  
        Si encuentro una coincidencia, te responderé directamente con una respuesta predefinida, diseñada para ser rápida, clara e incluso un poco ingeniosa.  
        Si no reconozco el patrón, entonces activo mis herramientas de búsqueda: genero representaciones vectoriales (embeddings) y busco los fragmentos más relevantes entre varios documentos —incluyendo el propio informe, archivos PDF y HTML externos, y sesiones de preguntas y respuestas (QA).  
        A partir de esa información, creo un resumen que intenta ofrecerte una respuesta coherente y útil basada en el contenido existente.
      </p>

      <p>
        Se debe tener en cuenta que este entorno es experimental. No utilizo grandes modelos de lenguaje, por lo que algunas respuestas pueden ser aproximadas o incompletas.  
        El objetivo principal es facilitar una visualización rápida, comprensible y reproducible de la información contenida en los documentos, permitiendo una exploración más dinámica del informe.
      </p>

      <p>
        Actualmente, los resultados pueden variar en precisión, ya que empleo modelos ligeros y locales para asegurar que la aplicación funcione en cualquier entorno sin necesidad de servidores externos.  
        Sin embargo, la estructura del sistema está preparada para mejorar notablemente su rendimiento en el futuro mediante la integración con modelos más avanzados o APIs externas.  
        Para comenzar, simplemente escribe tu pregunta en el campo inferior y deja que yo me encargue del resto. ¡Prometo poner todo mi código en ello!
      </p>
    </div>
    <div id="chat-log"></div>
    <input id="chat-input" type="text" placeholder="Escribe tu pregunta..."/>
    <button id="chat-send" title="Enviar">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path d="M2 21l21-9L2 3v7l15 2-15 2v7z"/>
      </svg>
    </button>
  </div>
</div>
```


<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  IMPORTACIONES
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->

<!-- Incluir Font Awesome -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">










<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  TAB 3: ANÁLISIS | 5.2. EVALUACIÓN DEL CONTROL DE CALIDAD TRAS LA NORMALIZACIÓN -->
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->

```{r}
library(stringr)
library(glue)
library(fs)
library(dplyr)

# Rutas clave
ruta_qmd <- getwd()
ruta_bulk_rna_seq_pipeline <- file.path("..", "..", "..", "..", "..", "..")
ruta_bulk_rna_seq_pipeline_absoluta <- normalizePath(ruta_bulk_rna_seq_pipeline)
nombre_proyecto <- basename(params$project_path)
nombre_experimento <- basename(params$experiment_name)


# Rutas de resultados Nextflow
ruta_nextflow_results <- file.path(ruta_bulk_rna_seq_pipeline, "resources", "02-nextflow-results")
ruta_proyecto_relativa <- file.path(ruta_bulk_rna_seq_pipeline, "resources", "02-nextflow-results", "01-project-data", nombre_proyecto)


# Rutas de informe de control de calidad tras la normalización
ruta_experimento_QC <- file.path(params$project_path, "Resultados", nombre_experimento, paste0(nombre_experimento, "_QC.pdf"))
ruta_experimento_QC_relativa <- file.path(ruta_proyecto_relativa, "Resultados", nombre_experimento, paste0(nombre_experimento, "_QC.pdf"))
```


<div class="informe-titulo-tab">
  <h1>Pestaña</h1>
  <h2>Análisis bioinformático completo</h2>
</div>

<div class="informe-titulo-seccion">
  <h1>Sección 5</h1>
  <h2>Análisis estadístico de la expresión génica</h2>
</div>

<div class="informe-titulo-subseccion-unique">
  <h1>Subsección 5.2</h1>
  <h2>Evaluación del control de calidad tras la normalización</h2>
</div>

<div class="flecha-abajo">
  ▼
</div>


<div class="informe-resumen">
  <h2>Resumen</h2>

  <p>
    En este apartado se realiza una <strong>evaluación exhaustiva del control de calidad</strong> tras la normalización de los datos de expresión génica. Este paso es crucial para comprobar que la normalización ha corregido adecuadamente las <em>variaciones técnicas</em> inherentes al proceso experimental, sin afectar la <em>estructura biológica real</em> de las muestras analizadas.
  </p>

  <p>
    Para ello, se aplican diversas técnicas exploratorias y visualizaciones estadísticas que permiten evaluar la homogeneidad y coherencia de los datos normalizados. Entre estas técnicas se incluyen el <strong>Análisis de Componentes Principales (PCA)</strong>, que facilita la identificación de agrupamientos y posibles outliers; el cálculo de la <strong>matriz de correlación</strong> entre muestras, que cuantifica similitudes globales; y el <strong>clustering jerárquico</strong>, que organiza las muestras según patrones de expresión comunes.
  </p>

  <p>
    Asimismo, se generan <strong>mapas de calor (heatmaps)</strong> y gráficos de distribución como <em>boxplots</em> y <em>density plots</em> que ofrecen una visión integral sobre la variabilidad y consistencia de la expresión génica tras el ajuste. Estas herramientas facilitan la detección de posibles muestras problemáticas o artefactos remanentes que podrían afectar la interpretación biológica.
  </p>

  <p>
    Todos estos análisis y visualizaciones se compilan en un <strong>informe consolidado en formato PDF</strong>, disponible para consulta y descarga en la ruta especificada, sirviendo como una guía valiosa para validar la calidad del dataset y asegurar la fiabilidad de los análisis posteriores de expresión diferencial y enriquecimiento funcional.
  </p>
</div>











<div style="height: 15px; background-color: transparent;"></div>

<div class="titulo-toc">
  Tabla de contenidos de esta subsección
</div>

<div class="toc">
  <ul>
    <li>
      <a href="5-Analisis-estadistico.html#tab3-seccion5">
        5<span>.</span> Análisis estadístico de la expresión génica
      </a>
      <ul>
        <li>
          <a href="#tab3-seccion5.2">
            5.2. Evaluación del control de calidad tras la normalización
          </a>
        </li>
      </ul>
    </li>
  </ul>
</div>










<!-- #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->
<!-- REDACCIÓN -->
<!-- #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->

<div style="height: 20px; background-color: transparent;"></div>

<div class="titulo2" id="tab3-seccion5.2">
  5.2. Evaluación del control de calidad tras la normalización
</div>

<p>
  Tras aplicar el <strong>proceso de normalización</strong> a la matriz de expresión génica, es fundamental realizar una <strong>evaluación global de la calidad</strong> de los datos resultantes.
  Esta etapa permite verificar que el <strong>preprocesamiento</strong> ha corregido adecuadamente las <em>fuentes de variación técnica</em>, sin alterar la <em>estructura biológica</em> de las muestras.
</p>

<p>
  Para ello, se han generado una serie de <strong>gráficos diagnósticos</strong> a partir de la matriz normalizada, utilizando enfoques exploratorios como:
</p>

<ul>
  <li><strong>Análisis de Componentes Principales (PCA)</strong></li>
  <li><strong>Matriz de correlación entre muestras</strong></li>
  <li><strong>Clustering jerárquico</strong></li>
  <li><strong>Mapas de calor (heatmaps)</strong></li>
  <li><strong>Distribuciones de expresión (boxplots, density plots)</strong></li>
</ul>

<p>
  Este conjunto de visualizaciones se ha reunido en un único <strong>informe en formato PDF</strong>, disponible, en el momento de la generación de este informe, en el siguiente directorio:
</p>

```{r, echo=FALSE, results="asis"}
cat(glue::glue('
  <code>{ruta_experimento_QC}</code>
'), sep = "\n")
```

<p>
  Y el cuál podemos visualizar en la siguiente ventana dinámica:
</p>

```{r, results='asis'}
if (file.exists(ruta_experimento_QC_relativa)) {
  cat(glue::glue('
  <div class="iframe-container">
    <iframe src="{ruta_experimento_QC_relativa}" frameborder="0" style="height: 700px;"></iframe>
  </div>

  <div style="display: flex; justify-content: center; gap: 25px;">
    <a href="{ruta_experimento_QC_relativa}"
      target="_blank" 
      class="boton-iframe">
      <i class="fa-solid fa-file-lines"></i> Abrir informe en una pestaña nueva
    </a>

    <a href="{ruta_experimento_QC_relativa}"
      download="{basename(ruta_experimento_QC_relativa)}"
      class="boton-iframe-download">
      <i class="fa-solid fa-file-arrow-down"></i> Descargar informe
    </a>
  </div>
  '), sep = "\n")

} else {
  cat(glue::glue('
    <div class="alert-warning alert-box">
      <i class="fa-solid fa-triangle-exclamation"></i>
      <b>Advertencia</b><br>
      Archivo "{basename(ruta_experimento_QC)}" no encontrado en la ruta especificada:<br>
      <code>{ruta_experimento_QC}</code>.<br>
      Asegúrese de que dicho archivo se encuentra correctamente definido en este directorio.
    </div>
  '), sep = "\n")
}
```

<p>
  Así, más en detalle, en este documento se encuentran los siguientes tipos de gráficos:
</p>

<ul>
  <li>
    <strong>Curvas de densidad log-CPM</strong> <strong>&rArr;</strong> permiten visualizar la distribución de los valores de expresión (en escala logarítmica) para cada muestra antes y después del filtrado de baja expresión. Estas curvas ayudan a detectar diferencias entre muestras y evaluar la homogeneidad tras el filtrado.
  </li>
  <li>
    <strong>Boxplots de expresión por muestra</strong> <strong>&rArr;</strong> muestran la distribución estadística de los valores normalizados para cada muestra, antes y después de la normalización. Permiten identificar posibles outliers o sesgos sistemáticos eliminados.
  </li>
  <li>
    <strong>Tamaño de las bibliotecas</strong> <strong>&rArr;</strong> indica el número total de lecturas asignadas por muestra, lo que proporciona una medida de la profundidad de secuenciación y justifica la necesidad de normalizar.
  </li>
  <li>
    <strong>Matriz de correlación entre muestras</strong> <strong>&rArr;</strong> muestra el coeficiente de correlación entre todos los pares de muestras en base a sus perfiles de expresión génica normalizada. 
    Una alta correlación entre réplicas biológicas indica consistencia experimental y buena calidad de los datos. Las discrepancias pueden sugerir outliers o errores técnicos.
  </li>
  <li>
    <strong>Análisis de componentes principales (PCA) y MDS</strong> <strong>&rArr;</strong> ofrecen representaciones bidimensionales de la varianza entre muestras, agrupándolas según su perfil de expresión génica. Una separación clara entre grupos experimentales respalda la existencia de diferencias biológicas significativas.
  </li>
  <li>
    <strong>Mapa de calor con clustering jerárquico</strong> <strong>&rArr;</strong> representa los genes más variables del experimento, mostrando su expresión en todas las muestras. El agrupamiento resultante permite evaluar la coherencia entre réplicas y condiciones experimentales.
  </li>
</ul>

<p>
  Estas representaciones gráficas permiten confirmar la calidad de los datos normalizados y ofrecen una visión global que facilita la interpretación de los patrones biológicos presentes en el experimento. 
  A partir de este punto, el análisis se centra en la identificación de genes diferencialmente expresados entre condiciones.
</p>










<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  FOOTER
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->

<footer>
  <a href="#" class="arriba"><i class="fa-solid fa-angles-up"></i></a>
</footer>










<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  CARGAR SCRIPTS DE JAVASCRIPT
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->

<script type="module" src="../../../04-javascript/chatbot.js"></script>
<script type="module" src="../../../04-javascript/script.js"></script>
