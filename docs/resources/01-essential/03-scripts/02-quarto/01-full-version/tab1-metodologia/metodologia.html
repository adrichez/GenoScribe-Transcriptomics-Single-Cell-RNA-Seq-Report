<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>IPBLN Bioinformatics Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../../">
<script src="../../../../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../../site_libs/quarto-html/quarto-syntax-highlighting-de8274a4d1ecc1e6aaeaf6e5564b5074.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../../site_libs/bootstrap/bootstrap-c27fce070f9e1faf5b65ec12c04f7688.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link rel="shortcut icon" href="../../../../01-images/icons/favicon.svg">
<link rel="icon" type="image/x-icon" href="../../../../01-images/icons/favicon.ico">


<link rel="stylesheet" href="../../../../../../resources/01-essential/03-scripts/03-css/styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../../../index.html">
    <span class="navbar-title"><img class="brand-logo" src="../../../../../../resources/01-essential/01-images/icons/ipbln.png"> <a class="brand-text" href="https://www.ipb.csic.es/servicios/Bioinformatica/index.html">IPBLN</a></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../../index.html"> <i class="bi bi-house" role="img">
</i> 
<span class="menu-text">Inicio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../../../../../resources/01-essential/03-scripts/02-quarto/01-full-version/tab1-metodologia/metodologia.html" aria-current="page"> <i class="bi bi-wrench" role="img">
</i> 
<span class="menu-text">Metodología</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../../resources/01-essential/03-scripts/02-quarto/01-full-version/tab2-resumen/resumen.html"> <i class="bi bi-clipboard-data" role="img">
</i> 
<span class="menu-text">Resumen</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-análisis" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-bar-chart" role="img">
</i> 
 <span class="menu-text">Análisis</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-análisis">    
        <li>
    <a class="dropdown-item" href="../../../../../../resources/01-essential/03-scripts/02-quarto/01-full-version/tab3-analisis/0-contexto.html">
 <span class="dropdown-text">➤ Introducción contextual</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../resources/01-essential/03-scripts/02-quarto/01-full-version/tab3-analisis/1-revision-inicial.html">
 <span class="dropdown-text">1. Revisión inicial de muestras y metadatos</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../resources/01-essential/03-scripts/02-quarto/01-full-version/tab3-analisis/2-evaluacion-calidad.html">
 <span class="dropdown-text">2. Evaluación de calidad de las lecturas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../resources/01-essential/03-scripts/02-quarto/01-full-version/tab3-analisis/3-alineamiento.html">
 <span class="dropdown-text">3. Alineamiento de las lecturas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../resources/01-essential/03-scripts/02-quarto/01-full-version/tab3-analisis/4-cuantificacion.html">
 <span class="dropdown-text">4. Cuantificación de la expresión génica</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../resources/01-essential/03-scripts/02-quarto/01-full-version/tab3-analisis/5-analisis-estadistico.html">
 <span class="dropdown-text">5. Análisis estadístico de la expresión génica</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../../../resources/01-essential/03-scripts/02-quarto/01-full-version/tab3-analisis/6-conclusiones.html">
 <span class="dropdown-text">6. Conclusiones y perspectivas</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-layout-custom page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
<!-- main -->

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">IPBLN Bioinformatics Report</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  CHATBOT
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!-- Contenedor del chat -->
<div id="chat-container">
  <button id="chat-toggle"></button>
  <div id="chat-box">
    <div id="chat-info" class="chat-info">
      <h1>
        Mini Chat RAG (beta)
      </h1>

      <p>
        ¡Hola! Soy <strong>Geni</strong>, el asistente inteligente de <strong>GenoScribe</strong>.  
        Estoy aquí para ayudarte a explorar de forma interactiva el contenido de este informe bioinformático.
      </p>

      <p>
        Cuando me haces una pregunta, primero intento reconocer si coincide con alguno de los patrones o expresiones que conozco.  
        Si encuentro una coincidencia, te responderé directamente con una respuesta predefinida, diseñada para ser rápida, clara e incluso un poco ingeniosa.  
        Si no reconozco el patrón, entonces activo mis herramientas de búsqueda: genero representaciones vectoriales (embeddings) y busco los fragmentos más relevantes entre varios documentos —incluyendo el propio informe, archivos PDF y HTML externos, y sesiones de preguntas y respuestas (QA).  
        A partir de esa información, creo un resumen que intenta ofrecerte una respuesta coherente y útil basada en el contenido existente.
      </p>

      <p>
        Se debe tener en cuenta que este entorno es experimental. No utilizo grandes modelos de lenguaje, por lo que algunas respuestas pueden ser aproximadas o incompletas.  
        El objetivo principal es facilitar una visualización rápida, comprensible y reproducible de la información contenida en los documentos, permitiendo una exploración más dinámica del informe.
      </p>

      <p>
        Actualmente, los resultados pueden variar en precisión, ya que empleo modelos ligeros y locales para asegurar que la aplicación funcione en cualquier entorno sin necesidad de servidores externos.  
        Sin embargo, la estructura del sistema está preparada para mejorar notablemente su rendimiento en el futuro mediante la integración con modelos más avanzados o APIs externas.  
        Para comenzar, simplemente escribe tu pregunta en el campo inferior y deja que yo me encargue del resto. ¡Prometo poner todo mi código en ello!
      </p>
    </div>
    <div id="chat-log"></div>
    <input id="chat-input" type="text" placeholder="Escribe tu pregunta...">
    <button id="chat-send" title="Enviar">
      <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24">
        <path d="M2 21l21-9L2 3v7l15 2-15 2v7z"></path>
      </svg>
    </button>
  </div>
</div>
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  IMPORTACIONES
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!-- Incluir Font Awesome -->
<p><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"></p>
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  TAB 1: METODOLOGÍA -->
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<div class="informe-titulo-tab-unique">
<h1>
Pestaña
</h1>
<h2>
Metodología y Herramientas
</h2>
</div>
<div class="flecha-abajo">
<p>▼</p>
</div>
<div class="informe-resumen">
<h2>
Resumen
</h2>
<p>
Esta pestaña tiene un carácter eminentemente técnico y documenta cómo se ha generado el informe, qué datos se han utilizado, qué herramientas han intervenido y cómo se ha organizado el flujo de trabajo. Su finalidad es que cualquier persona que consulte este informe pueda comprender los procedimientos realizados, verificar los resultados y, si lo desea, reproducir el análisis completo con exactitud.
</p>
<p>
Durante la elaboración del informe, se proporcionan los siguientes parámetros de ejecución:
</p>
<ul>
<li>
<strong>project_path</strong> ⇒ ruta que contiene los resultados del análisis completo realizado conjuntamente con el pipeline de <strong>miARma‑Seq</strong> y el posterior estudio mediante <strong>R</strong>.
</li>
<li>
<strong>experiment_name</strong> ⇒ nombre del experimento, ya que dentro de <code>project_path</code> puede haber varias carpetas correspondientes a diferentes experimentos.
</li>
<li>
<strong>report_version</strong> ⇒ define la versión del informe a generar, que puede ser <code>full</code> o <code>compact</code>.
</li>
</ul>
<p>
Los datos del informe provienen de un análisis integral realizado conjuntamente con la herramienta <strong>miARma‑Seq</strong> (<em>Eduardo Andrés-León et al.</em>) y el <strong>lenguaje de programación R</strong>, procesándose los archivos <code>FASTQ</code> desde la fase de control de calidad hasta la cuantificación de genes y análisis diferencial, incluyendo mRNA, miRNA y circRNA. Esta herramienta (junto con el posterior análisis en R), genera reportes intermedios y finales de cada etapa, permitiendo un flujo de trabajo completo y reproducible.
</p>
<p>
Una vez finalizado el análisis, <strong>Nextflow</strong> organiza los resultados y prepara los archivos de configuración que sirven como interfaz con <strong>Quarto</strong>:
</p>
<ul>
<li>
<strong><code>params.yml</code></strong> ⇒ contiene parámetros específicos de la ejecución, rutas de los resultados, nombre del experimento, versión del informe y opciones de visualización.
</li>
<li>
<strong><code>_quarto.yml</code></strong> ⇒ define la estructura del informe, incluyendo plantillas, pestañas, secciones y rutas internas, generado mediante <code>yaml_generator.py</code>.
</li>
</ul>
<p>
Cuando todos los procesos previos han finalizado, Nextflow invoca <code>quarto render</code>, generando el informe HTML final en la carpeta <code>report/</code>. Este flujo asegura que el documento refleje de manera completa, consistente y reproducible todos los resultados transcriptómicos.
</p>
<p>
Gracias a esta arquitectura modular:
</p>
<ul>
<li>
Cada etapa del análisis (control de calidad, alineamiento, cuantificación, análisis diferencial, análisis funcional y generación del informe) puede ejecutarse de forma independiente o conjunta.
</li>
<li>
Se permite procesar múltiples experimentos dentro de la misma carpeta raíz sin comprometer la trazabilidad ni la reproducibilidad.
</li>
<li>
Se facilita la verificación y reconstrucción del informe en el futuro con los mismos datos y parámetros.
</li>
</ul>
<p>
Además, esta pestaña incluye referencias a manuales, repositorios y documentación complementaria, accesibles mediante tarjetas de información. Para cualquier duda o soporte adicional, los datos de contacto se encuentran en la pestaña de inicio.
</p>
</div>
<div style="height: 15px; background-color: transparent;">

</div>
<div class="titulo-toc">
<p>Tabla de contenidos de esta pestaña</p>
</div>
<div class="toc">
<ul>
<li>
<a href="#tab1-seccion1">1<span>.</span> Workflows y herramientas empleadas en la generación de resultados</a>
<ul>
<li>
<a href="#tab1-seccion1.1">1.1. Workflow empleado con miARma-Seq</a>
</li>
</ul>
</li>
<li>
<a href="#tab1-seccion2">2<span>.</span> Estructura de los datos y resultados generados</a>
</li>
<li>
<a href="#tab1-seccion3">3<span>.</span> Generación automatizada del informe</a>
<ul>
<li>
<a href="#tab1-seccion3.1">3.1. Estructura del directorio de ejecución</a>
</li>
<li>
<a href="#tab1-seccion3.2">3.2. Integración de Nextflow y Quarto</a>
</li>
<li>
<a href="#tab1-seccion3.3">3.3. Configuración del archivo _quarto.yml y params.yml</a>
</li>
</ul>
</li>
<li>
<a href="#tab1-seccion4">4<span>.</span> Manuales, repositorios y documentación complementaria</a>
</li>
</ul>
</div>
<!-- #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->
<!-- REDACCIÓN -->
<!-- #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->
<div style="height: 20px; background-color: transparent;">

</div>
<div id="tab1-seccion1" class="titulo2">
<p>1<span>.</span> Workflows y herramientas empleadas en la generación de resultados</p>
</div>
<p>
El proceso de análisis de RNA-Seq llevado a cabo en este estudio se sustenta en el uso del pipeline <strong>miARma‑Seq</strong> (<em>Eduardo Andrés-León et al.</em>), junto con el <strong>lenguaje de programación R</strong>, permitiendo realizar un flujo de trabajo completo y reproducible desde los archivos <code>FASTQ</code> hasta la obtención de resultados de expresión diferencial y análisis funcional.
</p>
<p>
La herramienta <strong>miARma‑Seq</strong> combina múltiples etapas fundamentales en un pipeline modular y configurable: control de calidad de lecturas, alineamiento al genoma de referencia, cuantificación de genes e isoformas, análisis de miRNA y circRNA, identificación de genes diferencialmente expresados y análisis funcional de enriquecimiento biológico. La herramienta genera reportes intermedios y finales que permiten evaluar la calidad de los datos en cada fase y garantizar resultados consistentes y reproducibles.
</p>
<p>
Gracias a su diseño modular, <strong>miARma‑Seq</strong> permite ejecutar todo el flujo de análisis de manera automática o seleccionar pasos específicos según las necesidades del estudio. Esto asegura que los resultados sean comparables entre experimentos y facilita la integración en entornos de análisis reproducibles mediante <strong>Nextflow</strong> y <strong>Quarto</strong>.
</p>
<p>
En los siguientes apartados se describen con detalle las principales etapas de ejecución de <strong>miARma‑Seq</strong>, incluyendo su configuración, el flujo de procesamiento de datos y los tipos de resultados obtenidos.
</p>
<div style="height: 15x; background-color: transparent;">

</div>
<div id="tab1-seccion1.1" class="titulo3">
<p>1.1. Workflow empleado con miARma-Seq</p>
</div>
<p>
El proyecto de <strong>miARma‑Seq</strong> es un pipeline integral diseñado para el análisis de <strong>RNA‑Seq</strong> (mRNA, miRNA y circRNA), desarrollado por <em>Eduardo Andrés‑León et al.</em> y mantenido por el grupo de Bioinformática del IPBLN-CSIC. Esta herramienta permite realizar un flujo de trabajo completo y reproducible desde los archivos <code>FASTQ</code> hasta la generación de resultados de expresión diferencial y análisis funcional, integrando todas las etapas principales de análisis transcriptómico.
</p>
<p>
El pipeline incluye módulos modulares y configurables que permiten procesar los datos de manera escalable y flexible:
</p>
<ol>
<li>
<strong>Control de calidad inicial</strong> ⇒ Evaluación de los archivos <code>FASTQ</code> mediante <em>FastQC</em>, con reportes individuales y resúmenes globales mediante <em>MultiQC</em>. Esto permite detectar adaptadores, sesgos de composición y problemas de calidad por posición.
</li>
<li>
<strong>Recorte de lecturas</strong> ⇒ Eliminación de adaptadores y bases de baja calidad usando <em>Cutadapt</em> o <em>Reaper</em>, optimizando los datos antes del alineamiento.
</li>
<li>
<strong>Alineamiento</strong> ⇒ Mapeo de lecturas al genoma de referencia utilizando alineadores como <em>HISAT2</em>, <em>STAR</em>, <em>Bowtie</em> o <em>BWA</em>, dependiendo del tipo de RNA y del organismo.
</li>
<li>
<strong>Cuantificación</strong> ⇒ Conteo de genes o isoformas con <em>featureCounts</em>, cuantificación de miRNAs con <em>miRDeep2</em> y detección de circRNAs con <em>CIRI</em>.
</li>
<li>
<strong>Análisis diferencial</strong> ⇒ Identificación de genes, miRNAs o circRNAs diferencialmente expresados utilizando paquetes estadísticos como <em>edgeR</em> o <em>NOISeq</em>, adaptados al diseño experimental.
</li>
<li>
<strong>Análisis funcional</strong> ⇒ Predicción de interacciones miRNA‑mRNA, evaluación de correlaciones inversas de expresión y análisis de enriquecimiento funcional mediante <em>Gene Ontology (GO)</em> y <em>KEGG</em>.
</li>
<li>
<strong>Integración de datos y visualización</strong> ⇒ Generación de reportes intermedios y finales, incluyendo tablas de expresión, gráficos de expresión diferencial, correlaciones y análisis funcional, listos para su interpretación y comunicación científica.
</li>
</ol>
<p>
Esta herramienta, está diseñada para ser totalmente modular y configurable, permitiendo ejecutar el flujo completo de manera automática o seleccionar pasos específicos según las necesidades del estudio. Esto facilita la integración en entornos reproducibles mediante <strong>Nextflow</strong> y la presentación de resultados en <strong>Quarto</strong>, garantizando trazabilidad, reproducibilidad y claridad en la interpretación de datos transcriptómicos.
</p>
<p>
Toda la documentación, módulos, parámetros y ejemplos de uso de <strong>miARma‑Seq</strong> están disponibles en su <a href="https://github.com/eandresleon/miARma-seq" class="normalink" target="_blank">repositorio oficial en GitHub</a>. A continuación se muestra de forma esquemática el workflow completo del pipeline para RNA‑Seq:
</p>
<div class="box-images">
<p><img src="../../../../01-images/tab1-metodologia/miARma_Seq_workflow.png" alt="Pipeline completo de miARma-Seq" style="width: 850px; max-width: 100%;"></p>
</div>
<div style="display: flex; justify-content: center; gap: 25px;">
<p><a href="../../../../01-images/tab1-metodologia/miARma_Seq_workflow.png" target="_blank" class="boton-image"> <i class="fa-solid fa-sitemap"></i> Visualizar workflow en una página nueva </a></p>
<p><a href="../../../../01-images/tab1-metodologia/miARma_Seq_workflow.png" download="miARma_Seq_workflow.png" class="boton-image-download"> <i class="fa-solid fa-file-arrow-down"></i> Descargar imagen </a></p>
</div>
<p>
Para garantizar <strong>reproducibilidad</strong> y <strong>modularidad</strong>, <strong>miARma‑Seq</strong> utiliza un archivo de configuración con extensión <code>.ini</code>. Este archivo es fundamental, ya que contiene todos los parámetros necesarios para ejecutar cada módulo del pipeline (control de calidad, recorte de lecturas, alineamiento, cuantificación, análisis diferencial y análisis funcional) sin necesidad de introducir comandos complejos en la línea de comandos. En el contexto de este informe de <strong>Bulk RNA-Seq</strong>, el archivo <code>.ini</code> está configurado para ejecutar todo el flujo de análisis, asegurando que los resultados sean consistentes y reproducibles.
</p>
<p>
Así, para este informe, el archivo <code>.ini</code> utilizado se encuentra en el siguiente directorio:
</p>
<p>
<code>/workspace/data/0101-EXT-25-Transcriptomics-Bulk-RNA-Seq/Analisis/miARma_workflow.ini</code>.
</p>
<p>
Este archivo configura todos los módulos necesarios para el análisis completo de RNA-Seq y se puede consultar para verificar parámetros de control de calidad, alineamiento, cuantificación y análisis diferencial. Dicho archivo puede visualizarse mediante el siguiente <code>iframe</code> o, para más detalle, abrirse en una pestaña nueva haciendo click en el botón correspondiente. Además, es posible descargarlo mediante el botón específico ubicado junto al visor (para que la función de descarga funcione correctamente, se debe abrir el informe (<code>index.html</code>) mediante un servidor, tal como se indica en la pestaña de inicio).
</p>
<div class="iframe-container">
<p><iframe src="../../../../../../resources/01-essential/02-archives/02-tmp/tab1-metodologia/miARma_workflow.txt" frameborder="0" style="height: 500px;"></iframe></p>
</div>
<div style="display: flex; justify-content: center; gap: 25px;">
<p><a href="../../../../../../resources/01-essential/02-archives/02-tmp/tab1-metodologia/miARma_workflow.txt" target="_blank" class="boton-iframe"> <i class="fa-solid fa-file-lines"></i> Ver archivo completo en una nueva página </a></p>
<p><a href="../../../../../../resources/02-nextflow-results/01-project-data/0101-EXT-25-Transcriptomics-Bulk-RNA-Seq/Analisis/miARma_workflow.ini" download="miARma_workflow.ini" class="boton-iframe-download"> <i class="fa-solid fa-file-arrow-down"></i> Descargar archivo </a></p>
</div>
<p>
Un archivo <code>.ini</code> en <strong>miARma‑Seq</strong> está organizado en secciones claramente definidas, como <code>[General]</code>, <code>[QC]</code>, <code>[Aligner]</code>, <code>[ReadCount]</code>, <code>[DifferentialExpression]</code> o <code>[FunctionalAnalysis]</code>, cada una correspondiente a un módulo específico del pipeline de RNA-Seq. En cada sección se configuran parámetros esenciales, incluyendo:
</p>
<ul>
<li>
Rutas de entrada y salida de los archivos de secuencias y resultados intermedios.
</li>
<li>
Tipo de RNA a procesar (mRNA, miRNA, circRNA) y organismo de referencia.
</li>
<li>
Número de hilos o núcleos a utilizar para paralelización.
</li>
<li>
Herramientas y opciones específicas para cada etapa (FastQC, Cutadapt, HISAT2, STAR, featureCounts, miRDeep2, CIRI, edgeR, NOISeq, etc.).
</li>
<li>
Criterios de calidad, filtros de lectura y parámetros estadísticos aplicados en cada análisis.
</li>
<li>
Configuraciones para generación de reportes, visualización y análisis funcional (GO, KEGG).
</li>
</ul>
<p>
La ejecución del pipeline en un entorno de <strong>High-Performance Computing (HPC)</strong> se realiza mediante un archivo de script <code>.sh</code>, que automatiza la carga de módulos, la asignación de recursos (memoria y núcleos) y la ejecución de <strong>miARma‑Seq</strong> utilizando el archivo de configuración <code>.ini</code>.
</p>
<p>
Para este informe de <strong>Bulk RNA-Seq</strong>, el script <code>Slurm.sh</code>empleado se encuentra en el siguiente directorio:
</p>
<p>
<code>/workspace/data/0101-EXT-25-Transcriptomics-Bulk-RNA-Seq/Analisis/Slurm.sh</code>.
</p>
<p>
Y podemos visualizarlo de forma similar mediante el siguiente <code>iframe</code>, así como prodecer con su respectiva descarga.
</p>
<div class="iframe-container">
<p><iframe src="../../../../../../resources/01-essential/02-archives/02-tmp/tab1-metodologia/Slurm.txt" frameborder="0" style="height: 500px;"></iframe></p>
</div>
<div style="display: flex; justify-content: center; gap: 25px;">
<p><a href="../../../../../../resources/01-essential/02-archives/02-tmp/tab1-metodologia/Slurm.txt" target="_blank" class="boton-iframe"> <i class="fa-solid fa-file-lines"></i> Ver archivo completo en una nueva página </a></p>
<p><a href="../../../../../../resources/02-nextflow-results/01-project-data/0101-EXT-25-Transcriptomics-Bulk-RNA-Seq/Analisis/Slurm.sh" download="Slurm.sh" class="boton-iframe-download"> <i class="fa-solid fa-file-arrow-down"></i> Descargar archivo </a></p>
</div>
<p>
Gracias a esta estructura, es posible ejecutar de manera reproducible todo el flujo de análisis de <strong>RNA-Seq</strong> (mRNA, miRNA y circRNA), incluyendo control de calidad, recorte de lecturas, alineamiento, cuantificación, análisis diferencial y análisis funcional. La modularidad del pipeline permite activar o desactivar pasos específicos según las necesidades del estudio, integrando así un flujo de trabajo completo, escalable y reproducible.
</p>
<p>
Para más información sobre <strong>miARma‑Seq</strong> y su pipeline completo de RNA-Seq, se puede consultar el repositorio oficial en <a href="https://github.com/eandresleon/miARma-seq" class="normalink" target="_blank">GitHub: miARma‑Seq</a>.
</p>
<div style="height: 20px; background-color: transparent;">

</div>
<div id="tab1-seccion2" class="titulo2">
<p>2<span>.</span> Estructura de los datos y resultados generados</p>
</div>
<p>
Una vez completadas todas las etapas del flujo de análisis de <strong>RNA-Seq</strong> (mRNA, miRNA y circRNA) mediante <em>miARma‑Seq</em>, los resultados se organizan en una <strong>estructura de directorios</strong> que sirve como base para la generación de este informe automatizado. Esta organización incluye archivos intermedios, resultados finales y metadatos asociados a cada módulo del pipeline, garantizando la trazabilidad y la reproducibilidad del análisis completo.
</p>
<p>
Esta sección, al igual que el resto de la pestaña de metodología, tiene un propósito puramente técnico y está pensada como referencia interna para el usuario que generó el informe. Su objetivo es permitir comprender cómo se estructuran los datos de salida del proyecto, de modo que sea posible <strong>revisar rápidamente la organización de resultados</strong> sin necesidad de volver al entorno de análisis original.
</p>
<p>
A continuación se muestra la ruta del directorio principal donde se encuentran los datos y resultados generados para este proyecto:
</p>
<p><code>/workspace/data/0101-EXT-25-Transcriptomics-Bulk-RNA-Seq</code></p>
<p>
A continuación se muestra la estructura completa de dicho directorio. Esta representación permite visualizar los archivos y subcarpetas generados por <strong>miARma‑Seq</strong> y que se emplearon como base para la construcción del informe:
</p>
<div class="box-files">
<ul>
<li class="file-folder">
<a href="../../../../../../resources/02-nextflow-results/01-project-data/0101-EXT-25-Transcriptomics-Bulk-RNA-Seq/Analisis" target="_blank">Analisis</a>
</li>
<li class="file-folder">
<a href="../../../../../../resources/02-nextflow-results/01-project-data/0101-EXT-25-Transcriptomics-Bulk-RNA-Seq/Documentacion" target="_blank">Documentacion</a>
</li>
<li class="file-folder">
<a href="../../../../../../resources/02-nextflow-results/01-project-data/0101-EXT-25-Transcriptomics-Bulk-RNA-Seq/Resultados" target="_blank">Resultados</a>
</li>
</ul>
</div>
<p style="text-align:center;">
<a href="../../../../../../resources/02-nextflow-results/01-project-data/0101-EXT-25-Transcriptomics-Bulk-RNA-Seq" target="_blank" class="boton-files"> <i class="fa-solid fa-folder-open"></i> Explorar los archivos de la carpeta “0101-EXT-25-Transcriptomics-Bulk-RNA-Seq” aquí </a>
</p>
<p>
Tras visualizar la estructura de forma interactiva, se presenta a continuación un desglose detallado de las carpetas y archivos generados durante el análisis de RNA-Seq para el experimento <code>mary</code>, perteneciente al proyecto <code>0101-EXT-25-Transcriptomics-Bulk-RNA-Seq</code>. Esta organización está diseñada para facilitar la reproducibilidad del análisis, la trazabilidad de los resultados y su interpretación posterior.
</p>
<div class="items">
<ul>
<li>
<strong><code>0101-EXT-25-Transcriptomics-Bulk-RNA-Seq/Analisis/</code></strong> <strong>⇒</strong> Carpeta principal que agrupa todos los archivos a procesar y los resultados iniciales del análisis, incluyendo los reportes de control de calidad de las muestras y las subcarpetas generadas por <strong>miARma‑Seq</strong> durante el flujo de análisis completo de RNA-Seq:
<ul>
<li>
<strong><code>mary/</code></strong> <strong>⇒</strong> Directorio específico del experimento, que contiene las salidas intermedias y finales generadas durante todas las etapas del pipeline:
<ul>
<li>
<code>Pre_fastqc_results/</code> <strong>→</strong> Resultados de control de calidad de las lecturas crudas, generados por <em>FastQC</em> y consolidados con <em>MultiQC</em>. Estos informes permiten verificar la calidad general de las secuencias antes de pasar al recorte y alineamiento.
</li>
<li>
<code>hisat2_results/</code> <strong>→</strong> Archivos de alineamiento en formato <code>SAM/BAM</code> obtenidos mediante <em>HISAT2</em> o <em>STAR</em>, que reflejan cómo las lecturas se mapean al genoma de referencia del organismo estudiado.
</li>
<li>
<code>Readcount_results/</code> <strong>→</strong> Matrices de conteos brutos de expresión génica por gen y por muestra, antes de la normalización. Estos datos son la base para los análisis de expresión diferencial y downstream.
</li>
</ul>
</li>
<li>
<strong><code>reads_down_select_mary/</code></strong> <strong>⇒</strong> Carpeta donde se almacenan las lecturas filtradas o seleccionadas específicamente para el análisis de este experimento, listas para ser procesadas por los módulos de alineamiento y cuantificación.
</li>
</ul>
</li>
<li>
<strong><code>0101-EXT-25-Transcriptomics-Bulk-RNA-Seq/Resultados/</code></strong> <strong>⇒</strong> Carpeta que agrupa todos los resultados derivados del análisis, organizados para facilitar su exploración y revisión:
<ul>
<li>
<strong><code>targets_mary.txt</code></strong> <strong>⇒</strong> Archivo de metadatos con información sobre las muestras (nombre, condición, replicados, etc.), fundamental para el diseño experimental y el análisis estadístico posterior.
</li>
<li>
<strong><code>mary/</code></strong> <strong>⇒</strong> Subcarpeta con productos generados a partir de la matriz de expresión normalizada y los análisis estadísticos derivados:
<ul>
<li>
<code>mary_QC.pdf</code> <strong>→</strong> Informe gráfico posterior a la normalización. Incluye visualizaciones clave como PCA, clustering jerárquico, correlaciones entre muestras, boxplots y distribuciones de expresión. Estas gráficas permiten evaluar si el preprocesamiento ha corregido adecuadamente la variabilidad técnica sin distorsionar las señales biológicas relevantes.
</li>
<li>
<code>mary_RPKM.xls</code> <strong>→</strong> Matriz de expresión génica transformada a valores normalizados en unidades RPKM, adecuada para visualización y exploración comparativa entre muestras.
</li>
<li>
Archivos <code>.xlsx</code> <strong>→</strong> Resultados del análisis de expresión diferencial para cada comparación experimental. Incluyen medidas estadísticas (logFC, p-valor, FDR) para cada gen evaluado.
</li>
<li>
Archivos <code>Volcano.pdf</code> <strong>→</strong> Gráficos <em>volcano</em> que resumen visualmente los genes diferencialmente expresados más relevantes, combinando magnitud del cambio y significación estadística.
</li>
<li>
<code>Enrichment/</code> <strong>→</strong> Carpeta que contiene los resultados del análisis funcional y de enriquecimiento basado en los genes diferencialmente expresados (DEG). Para cada comparación entre condiciones experimentales se incluyen:
<ul>
<li>
Un archivo <code>.pdf</code> <strong>→</strong> con representaciones visuales (por ejemplo, <em>barplots</em> o <em>dotplots</em>) que destacan los términos funcionales más significativamente enriquecidos.
</li>
<li>
Un archivo <code>.xls</code> <strong>→</strong> con un listado exhaustivo de categorías enriquecidas (GO:BP, GO:MF, GO:CC y rutas KEGG), incluyendo valores de p, FDR y número de genes asociados a cada término.
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>
Esta estructura modular y coherente no solo permite automatizar los pasos clave del análisis bioinformático, sino que también garantiza trazabilidad, reproducibilidad y facilidad de interpretación. Además, contribuye a una mejor documentación del flujo de trabajo, lo cual es especialmente útil en entornos colaborativos o proyectos de largo recorrido.
</p>
<div style="height: 20px; background-color: transparent;">

</div>
<div id="tab1-seccion3" class="titulo2">
<p>3<span>.</span> Generación automatizada del informe</p>
</div>
<p>
Una vez obtenidos los datos procesados mediante el workflow de <strong>miARma‑Seq</strong> y mostrada la estructura del directorio en el cuál se encuentran los resultados generados a partir de todo el proceso de análisis, el siguiente paso consiste en la <strong>generación automatizada del informe final</strong>. Esta sección tiene como objetivo documentar de manera clara y reproducible todo el proceso mediante el cual se construye el informe, detallando la organización de los archivos de ejecución, la integración de herramientas y la configuración utilizada.
</p>
<p>
En particular, se abordarán los siguientes aspectos:
</p>
<ul>
<li>
<strong>3.1. Estructura del directorio de ejecución</strong> <strong>⇒</strong> Se mostrará la ubicación y organización de los archivos y carpetas desde los cuales se ejecuta el pipeline, incluyendo los scripts de Nextflow y los archivos asociados de Quarto. Esto permite al usuario técnico entender dónde se encuentran los datos, resultados intermedios y archivos de configuración necesarios para generar el informe.
</li>
<li>
<strong>3.2. Integración de Nextflow y Quarto</strong> <strong>⇒</strong> Se explicará cómo se ha utilizado <code>Nextflow</code> para automatizar la ejecución de Quarto y la generación del informe final, describiendo el rol de los scripts principales (<code>main.nf</code>) y cómo se coordinan las distintas etapas del pipeline.
</li>
<li>
<strong>3.3. Configuración del archivo <code>_quarto.yml</code> y <code>params.yml</code></strong> <strong>⇒</strong> Se mostrarán los archivos de configuración que permiten reproducir el informe exacto, incluyendo rutas de entrada, parámetros de análisis y opciones de visualización. Esta documentación asegura que cualquier usuario técnico pueda regenerar el informe con los mismos resultados en el futuro, garantizando trazabilidad y reproducibilidad.
</li>
</ul>
<p>
El propósito de esta sección es proporcionar un <strong>registro técnico completo</strong> del flujo de trabajo utilizado para generar el informe, de manera que cualquier persona que vuelva a consultar el proyecto pueda entender de forma clara cómo se ensamblaron los datos, qué herramientas se utilizaron y cómo se configuró todo el entorno de ejecución.
</p>
<div style="height: 15x; background-color: transparent;">

</div>
<div id="tab1-seccion3.1" class="titulo3">
<p>3.1. Estructura del directorio de ejecución</p>
</div>
<p>
En esta subsección se describe la <strong>estructura de archivos y carpetas</strong> desde la cual se ejecuta el pipeline de metagenómica que genera el informe automatizado. Esta información es fundamental para entender cómo se organizan los datos de entrada, los resultados intermedios y los archivos de configuración de Quarto y Nextflow.
</p>
<p>
La ruta raíz desde la cual se ejecuta este pipeline es:
</p>
<p><code>/workspace/GenoScribe/02-pipelines/01-transcriptomics/01-bulk-rna-seq</code></p>
<p>
A continuación se presenta la estructura completa del directorio correspondiente a este proyecto. Es importante destacar que los elementos listados (tanto archivos como subcarpetas) no representan enlaces interactivos, sino que se muestran únicamente para ilustrar la organización interna de los contenidos. Esta representación permite al lector comprender de manera clara y visual cómo se distribuyen los distintos componentes del proyecto, facilitando la navegación conceptual del directorio sin necesidad de acceder directamente a cada archivo.
</p>
<div class="box-files">
<ul class="box-files">
<li class="file-folder">
report
</li>
<li class="file-folder">
resources
</li>
<li class="file-folder">
work
</li>
<li class="file-yml">
_quarto.yml
</li>
<li class="file-qmd">
index.qmd
</li>
<li class="file-nf">
main.nf
</li>
<li class="file-config">
nextflow.config
</li>
<li class="file-yml">
params.yml
</li>
<li class="file-sh">
run_cleaning_dir.sh
</li>
<li class="file-sh">
run_pipeline_shell.sh
</li>
<li class="file-sh">
run_pipeline_shiny.sh
</li>
</ul>
</div>
<p style="text-align:center;">
<a href="../../../../../../workspace/GenoScribe/02-pipelines/01-transcriptomics/01-bulk-rna-seq" target="_blank" class="boton-files"> <i class="fa-solid fa-folder-open"></i> Explorar los archivos de la carpeta “01-bulk-rna-seq” aquí </a>
</p>
<p>
A continuación se detalla la organización principal del directorio raíz del pipeline (<code>01-bulk-rna-seq</code>). Esta descripción está pensada como referencia técnica: indica qué hace cada archivo o carpeta, dónde se guardan los datos generados y cómo se conectan las piezas para producir el <em>report</em> final.
</p>
<div class="items">
<ul>
<li>
<strong><code>_quarto.yml</code>, <code>index.qmd</code></strong> <strong>⇒</strong> Archivos base de <strong>Quarto</strong> que definen la estructura del informe (toc, formatos, parámetros globales) y la página de índice. Cada pestaña del informe está representada por un <code>.qmd</code>.
</li>
<li>
<strong><code>main.nf</code>, <code>nextflow.config</code>, <code>params.yml</code></strong> <strong>⇒</strong> Ficheros de control del pipeline de <strong>Nextflow</strong>:
<ul>
<li>
<code>main.nf</code> <strong>→</strong> script principal que orquesta las tareas (organización de los resultados, creación de scripts de configuración y renderizado del informe).
</li>
<li>
<code>nextflow.config</code> <strong>→</strong> configuración de ejecución (perfiles, recursos, módulos, rutas por defecto).
</li>
<li>
<code>params.yml</code> <strong>→</strong> parámetros concretos del proyecto (paths de entrada, opciones del pipeline) — generado o rellenado por el usuario/Nextflow para cada corrida.
</li>
</ul>
</li>
<li>
<strong><code>report/</code></strong> <strong>⇒</strong> Carpeta de salida donde Nextflow / Quarto depositan el informe final (HTML) y materiales derivados listos para compartir.
</li>
<li>
<strong><code>resources/</code></strong> <strong>⇒</strong> Repositorio local de recursos y de los resultados consolidados. A alto nivel:
<ul>
<li>
<code>resources/01-essential/</code> <strong>→</strong> recursos usados por las plantillas y por los <code>.qmd</code>:
<ul>
<li>
<code>01-images/</code> <strong>→</strong> iconos y gráficas (portada, diagramas de workflow, favicon, etc.).
</li>
<li>
<code>02-archives/</code> <strong>→</strong> copias de ficheros de interés (scripts, logs, ejemplos de <code>.ini</code>/<code>.sh</code>) usados como referencia o para descarga en la pestaña de metodología.
</li>
<li>
<code>03-scripts/</code> <strong>→</strong> scripts auxiliares (R, Quarto templates, CSS, JS, Python y Bash) que apoyan la construcción del informe y la generación de artefactos (p.&nbsp;ej. <code>yaml_generator.py</code>).
</li>
</ul>
</li>
<li>
<code>resources/02-nextflow-results/</code> <strong>→</strong> ubicación donde Nextflow consolida los resultados del/los proyecto(s):
<ul>
<li>
<code>01-project-data/{nombre_del_proyecto}/</code> <strong>→</strong> copia local del proyecto procesado (entrada + resultados). Nextflow copia aquí los datos de trabajo para que Quarto los consuma de forma estable y reproducible.
</li>
<li>
<code>02-multiqc-report/</code> <strong>→</strong> salida centralizada de los reports de FastQC / MultiQC generados por el QC inicial.
</li>
<li>
<code>03-analisis-estadistico/</code> <strong>→</strong> resultados exportados y productos intermedios listos para análisis estadísticos adicionales (por ejemplo exportes para R, tablas xlsx, gráficas volcán, etc.).
</li>
</ul>
</li>
</ul>
</li>
<li>
<strong><code>run_cleaning_dir.sh</code>, <code>run_pipeline_shell.sh</code>, <code>run_pipeline_shiny.sh</code></strong> <strong>⇒</strong> Scripts de <strong>utilidades</strong> en la raíz.
<ul>
<li>
<code>run_pipeline_shell.sh</code> <strong>→</strong> wrapper para lanzar el pipeline desde la terminal (ejecuta Nextflow con el perfil/params adecuados).
</li>
<li>
<code>run_pipeline_shiny.sh</code> <strong>→</strong> invoca una interfaz gráfica (Shiny) que permite ejecutar el pipeline mediante un formulario para usuarios menos técnicos.
</li>
<li>
<code>run_cleaning_dir.sh</code> <strong>→</strong> script para limpiar caches y ficheros temporales (útil para liberar espacio, especialmente cuando los resultados y cachés de Nextflow crecen mucho).
</li>
</ul>
</li>
</ul>
</div>
<p>
Una vez comentada la estructura general del directorio de ejecución, se puede señalar que el pipeline está organizado de manera modular para asegurar la reproducibilidad, la trazabilidad de los resultados y la claridad en la generación del informe. Los archivos <code>.qmd</code> representan las pestañas y subsecciones del informe, mientras que Nextflow se encarga de consolidar los resultados previos, generar reportes adicionales cuando es necesario y coordinar la ejecución de Quarto para producir el documento final.
</p>
<p>
Dentro de <code>resources/01-essential/03-scripts/02-quarto</code> se mantienen dos versiones de las plantillas: <code>01-full-version</code>, que incluye la pestaña de metodología y todas las secciones detalladas de análisis, y <code>02-compact-version</code>, que omite la pestaña de metodología y ofrece una versión más compacta del informe. Cada archivo <code>.qmd</code> corresponde a una pestaña o subsección específica.
</p>
<p>
Nextflow utiliza los resultados existentes del análisis metagenómico (control de calidad, abundancias y predicciones funcionales) almacenados en <code>resources/02-nextflow-results/01-project-data/{nombre_del_proyecto}</code> y realiza operaciones adicionales como la consolidación de resultados, generación de reportes MultiQC en <code>02-multiqc-report</code> y preparación de datos estadísticos en <code>03-analisis-estadistico</code>. Asimismo, genera los archivos de configuración que Quarto requiere, incluyendo <code>params.yml</code> y, mediante <code>yaml_generator.py</code>, <code>_quarto.yml</code> con los parámetros y rutas específicos del proyecto, para asegurar que la renderización del informe sea reproducible y consistente.
</p>
<p>
Para generar el informe, Nextflow invoca <code>quarto render</code> sobre los <code>.qmd</code> y los archivos de parámetros correspondientes, produciendo el HTML final en <code>report/</code>. Los scripts auxiliares en la raíz del proyecto, como <code>run_pipeline_shell.sh</code>, <code>run_pipeline_shiny.sh</code> y <code>run_cleaning_dir.sh</code>, permiten ejecutar el pipeline desde la terminal, mediante interfaz gráfica o limpiar caches y directorios temporales respectivamente.
</p>
<p>
Para reproducir un informe exacto, se requiere disponer de la copia completa de los resultados en <code>resources/02-nextflow-results/01-project-data/{nombre_del_proyecto}</code>, así como de los archivos <code>params.yml</code> y <code>_quarto.yml</code> generados durante la ejecución. Esta estructura modular facilita la localización de los archivos necesarios y asegura que cualquier usuario pueda reconstruir el informe de manera consistente.
</p>
<p>
Para detalles adicionales y pasos exactos de ejecución, se recomienda consultar la guía oficial del proyecto en GitHub: <a href="https://github.com/adrichez/GenoScribe/blob/main/06-info/0101_TRANSCRIPTOMICS_BULK_RNA_SEQ_GUIDE.md" target="_blank" class="normalink">GenoScribe: Guía del Pipeline para Transcriptómica Bull RNA-Seq</a>.
</p>
<div style="height: 15x; background-color: transparent;">

</div>
<div id="tab1-seccion3.2" class="titulo3">
<p>3.2. Integración de Nextflow y Quarto</p>
</div>
<p>
La integración entre <strong>Nextflow</strong> y <strong>Quarto</strong> constituye la base técnica que permite generar de forma automatizada el informe final a partir de los resultados del análisis de RNA-Seq. Este enfoque busca asegurar <strong>reproducibilidad</strong>, <strong>modularidad</strong> y <strong>trazabilidad</strong>, evitando la dependencia de pasos manuales y reduciendo el riesgo de inconsistencias entre los resultados y la documentación generada. A diferencia de un pipeline clásico, en este caso Nextflow no ejecuta los procesos analíticos de miARma-Seq, sino que <strong>consume sus resultados</strong> ya generados, realiza operaciones intermedias necesarias (copias estructuradas, generación de reportes auxiliares, preparación de parámetros) y finalmente <strong>invoca Quarto</strong> para la construcción del informe.
</p>
<p style="margin-botton: -25px">
El esquema general es el siguiente:
</p><ol>
<li>
Se define un conjunto de parámetros y rutas base mediante <code>nextflow.config</code>.
</li>
<li>
Nextflow inicia el pipeline, copia los archivos esenciales del proyecto a una estructura de trabajo reproducible, y ejecuta procesos auxiliares como MultiQC sobre los reportes de control de calidad.
</li>
<li>
Se generan o actualizan los archivos de configuración que Quarto utilizará (<code>params.yml</code> y <code>_quarto.yml</code>).
</li>
<li>
Finalmente, se invoca <code>quarto render</code> para ensamblar el informe HTML final de manera completamente automatizada.
</li>
</ol>
<p></p>
<p style="margin-top: -25px">
El archivo de configuración <strong><code>nextflow.config</code></strong>, ubicado en <code>/workspace/GenoScribe/02-pipelines/01-transcriptomics/01-bulk-rna-seq/nextflow.config</code>, es el punto de partida de esta integración. Define las variables globales del pipeline, incluyendo:
</p>
<ul>
<li>
<strong><code>outdir</code></strong> <strong>→</strong> Ruta de salida estándar donde se almacenarán los resultados y el informe final.
</li>
<li>
<strong><code>project_path</code></strong> <strong>→</strong> Ubicación del proyecto analizado, que contiene la estructura de directorios generada previamente por miARma-Seq y QIIME 2.
</li>
<li>
<strong><code>experiment_name</code></strong> <strong>→</strong> Especifica el nombre del específico del experimento analizado ya se puede dar el caso de que encontremos diversos carpetas relativas a distintos experimentos dentro del directorio raíz del proyecto.
</li>
<li>
<strong><code>report_version</code></strong> <strong>→</strong> Define la versión del informe a generar (<strong>full</strong> o <strong>compact</strong>), lo cual condiciona las pestañas y contenidos que Quarto renderizará.
</li>
</ul>
<p>
Una vez comentado esto, podemos visualizar dicho archivo mediante el siguiente <code>iframe</code>, así como explorarlo de forma más detallada en una página completa o descargarlo (hay que abrir el informe mediante un servidor para que esta acción funcione, como ya se ha mencionado).
</p>
<!-- IFRAME para nextflow.config -->
<div class="iframe-container">
<p><iframe src="../../../../../../resources/01-essential/02-archives/02-tmp/tab1-metodologia/nextflow.txt" frameborder="0" style="height: 500px;"></iframe></p>
</div>
<div style="display: flex; justify-content: center; gap: 25px;">
<p><a href="../../../../../../resources/01-essential/02-archives/02-tmp/tab1-metodologia/nextflow.txt" target="_blank" class="boton-iframe"> <i class="fa-solid fa-file-lines"></i> Ver archivo completo en una nueva página </a></p>
<p><a href="../../../../../../resources/01-essential/02-archives/02-tmp/tab1-metodologia/nextflow.config" download="nextflow.config" class="boton-iframe-download"> <i class="fa-solid fa-file-arrow-down"></i> Descargar archivo </a></p>
</div>
<p>
El archivo <strong><code>main.nf</code></strong>, ubicado en <code>/workspace/GenoScribe/02-pipelines/01-transcriptomics/01-bulk-rna-seq/main.nf</code>, constituye el núcleo del pipeline y orquesta los diferentes procesos necesarios para la preparación del informe. Entre las etapas más relevantes que gestiona este script se incluyen:
</p>
<ul>
<li>
<strong>Copia estructurada de archivos del proyecto</strong> <strong>⇒</strong> Se seleccionan únicamente los elementos esenciales (sin archivos de gran tamaño como FASTQ o BAM) para trasladarlos a <code>resources/02-nextflow-results/01-project-data/</code>. Esto garantiza que Quarto trabaje sobre una estructura consolidada y ligera.
</li>
<li>
<strong>Ejecución de MultiQC</strong> <strong>⇒</strong> A partir de los reportes de control de calidad (FastQC) generados en miARma-Seq, se ejecuta MultiQC para unificar la información y facilitar su visualización en el informe final.
</li>
<li>
<strong>Preparación de parámetros para Quarto</strong> <strong>⇒</strong> A partir de las variables definidas en <code>nextflow.config</code>, se generan los archivos <code>params.yml</code> y <code>_quarto.yml</code> (este último, mediante <code>yaml_generator.py</code>), los cuales actúan como interfaz entre el pipeline y Quarto.
</li>
<li>
<strong>Renderizado del informe</strong> <strong>⇒</strong> Cuando todos los procesos previos han finalizado satisfactoriamente, se invoca <code>quarto render</code> para construir el informe HTML en la carpeta <code>report/</code>. Esto asegura que el informe se genere siempre con datos completos y parámetros consistentes.
</li>
</ul>
<p>
De igual modo, podemos visualizar este archivo mediante el siguiente <code>iframe</code>, así como explorarlo de forma más detallada en una página completa o descargándolo.
</p>
<!-- IFRAME para main.nf -->
<div class="iframe-container">
<p><iframe src="../../../../../../resources/01-essential/02-archives/02-tmp/tab1-metodologia/main.txt" frameborder="0" style="height: 500px;"></iframe></p>
</div>
<div style="display: flex; justify-content: center; gap: 25px;">
<!-- Botón ver archivo completo -->
<p><a href="../../../../../../resources/01-essential/02-archives/02-tmp/tab1-metodologia/miARma_workflow.txt" target="_blank" class="boton-iframe"> <i class="fa-solid fa-file-lines"></i> Ver archivo completo en una nueva página </a></p>
<p><!-- Botón descargar archivo --> <a href="../../../../../../resources/02-nextflow-results/01-project-data/0101-EXT-25-Transcriptomics-Bulk-RNA-Seq/Analisis/miARma_workflow.ini" download="miARma_workflow.ini" class="boton-iframe-download"> <i class="fa-solid fa-file-arrow-down"></i> Descargar archivo </a></p>
</div>
<p>
Este diseño modular permite ampliar o modificar el pipeline fácilmente sin comprometer su reproducibilidad. Al separar claramente las etapas de preparación de datos y la generación del informe, se facilita la trazabilidad de cada componente y se asegura que cualquier informe pueda ser <strong>reconstruido en el futuro</strong> a partir de los mismos parámetros y estructura de resultados.
</p>
<div style="height: 15x; background-color: transparent;">

</div>
<div id="tab1-seccion3.3" class="titulo3">
<p>3.3. Configuración del archivo _quarto.yml y params.yml</p>
</div>
<p>
Una vez ejecutado el pipeline de <strong>Nextflow</strong>, se generan los archivos de configuración <strong><code>_quarto.yml</code></strong> y <strong><code>params.yml</code></strong>. Estos archivos constituyen la interfaz entre el pipeline y <strong>Quarto</strong>, permitiendo que el último paso del flujo de trabajo ejecute <code>quarto render</code> y construya el informe HTML final a partir de los datos y parámetros proporcionados.
</p>
<p>
El archivo <code>params.yml</code> contiene todos los parámetros específicos de la ejecución, incluyendo rutas de archivos, opciones de visualización, marcador analizado, versión del informe y metadatos relevantes del proyecto. Por su parte, <code>_quarto.yml</code> establece la estructura del informe, definiendo las plantillas, pestañas, secciones a renderizar y rutas internas, mediante la ejecución del script <code>yaml_generator.py</code>. Juntos, estos archivos permiten que la generación del informe sea completamente automatizada, consistente y reproducible.
</p>
<p>
A continuación se puede visualizar <code>params.yml</code> mediante un <code>iframe</code>, explorar su contenido de manera interactiva, o abrirlo en una página completa y descargarlo si se desea:
</p>
<!-- IFRAME para params.yml -->
<div class="iframe-container">
<p><iframe src="../../../../../../resources/01-essential/02-archives/02-tmp/tab1-metodologia/params.txt" frameborder="0" style="height: 500px;"></iframe></p>
</div>
<div style="display: flex; justify-content: center; gap: 25px;">
<p><a href="../../../../../../resources/01-essential/02-archives/02-tmp/tab1-metodologia/params.txt" target="_blank" class="boton-iframe"> <i class="fa-solid fa-file-lines"></i> Ver archivo completo en una nueva página </a></p>
<p><a href="../../../../../../resources/01-essential/02-archives/02-tmp/tab1-metodologia/params.yml" download="params_yml" class="boton-iframe-download"> <i class="fa-solid fa-file-arrow-down"></i> Descargar archivo </a></p>
</div>
<p>
Una vez comprendido el contenido de <code>params.yml</code>, se puede observar <code>_quarto.yml</code>, que actúa como guía estructural para Quarto, indicando qué plantillas y secciones deben incluirse y cómo deben organizarse dentro del informe. Este archivo es esencial para que <code>quarto render</code> genere un documento final coherente con los datos del proyecto.
</p>
<!-- IFRAME para _quarto.yml -->
<div class="iframe-container">
<p><iframe src="../../../../../../resources/01-essential/02-archives/02-tmp/tab1-metodologia/_quarto.txt" frameborder="0" style="height: 500px;"></iframe></p>
</div>
<div style="display: flex; justify-content: center; gap: 25px;">
<p><a href="../../../../../../resources/01-essential/02-archives/02-tmp/tab1-metodologia/_quarto.txt" target="_blank" class="boton-iframe"> <i class="fa-solid fa-file-lines"></i> Ver archivo completo en una nueva página </a></p>
<p><a href="../../../../../../resources/01-essential/02-archives/02-tmp/tab1-metodologia/_quarto.yml" download="quarto_yml" class="boton-iframe-download"> <i class="fa-solid fa-file-arrow-down"></i> Descargar archivo </a></p>
</div>
<p>
Esta arquitectura garantiza que cualquier informe pueda ser reproducido en el futuro de manera exacta, siempre que se disponga de los mismos resultados consolidados en <code>resources/02-nextflow-results/01-project-data/nombre_del_proyecto</code> y de los archivos <code>params.yml</code> y <code>_quarto.yml</code> generados por el pipeline. La separación clara entre la preparación de datos y la generación del informe asegura trazabilidad, modularidad y consistencia en los reportes finales.
</p>
<div style="height: 20px; background-color: transparent;">

</div>
<div id="tab1-seccion4" class="titulo2">
<p>4<span>.</span> Manuales, repositorios y documentación complementaria</p>
</div>
<p>
Esta sección final cierra la pestaña de metodología, dirigida principalmente a usuarios interesados en comprender en detalle cómo se ha generado el informe, qué datos se han utilizado y cómo se ha estructurado la integración entre Nextflow y Quarto. La información aquí proporcionada permite acceder a recursos adicionales, consultar la documentación técnica y localizar los repositorios de código para revisar o reutilizar los scripts empleados.
</p>
<p>
De manera similar a las tarjetas de inicio, se presentan a continuación algunas tarjetas informativas que facilitan el acceso rápido a los recursos clave relacionados con este proyecto:
</p>
<div class="contact-cards">
<div class="contact-card blue">
<i class="fa-brands fa-github fa-2x"></i>
<p>
<strong>Repositorio de código</strong>
</p>
<p><a href="https://github.com/adrichez/GenoScribe" target="_blank">GitHub del proyecto</a></p>
</div>
<div class="contact-card green">
<i class="fa-solid fa-book fa-2x"></i>
<p>
<strong>Documentación</strong>
</p>
<p><a href="https://github.com/adrichez/GenoScribe/blob/main/6-info/1_BULK_RNA_SEQ_GUIDE.md" target="_blank">Manual de uso</a></p>
</div>
<div class="contact-card purple">
<i class="fa-solid fa-calendar fa-2x"></i>
<p>
<strong>Fecha de creación del informe</strong>
</p>
<p><span>2026-02-24</span></p>
</div>
</div>
<p style="margin-top: 25px;">
Para cualquier duda adicional o consultas de soporte, se puede recurrir a los datos de contacto que se muestran en la pestaña de inicio del informe, donde se incluyen enlaces a la Unidad de Bioinformática del CSIC y al correo de soporte.
</p>
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  FOOTER
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<footer>
<a href="#" class="arriba"><i class="fa-solid fa-angles-up"></i></a>
</footer>
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<!--  CARGAR SCRIPTS DE JAVASCRIPT
<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
<script type="module" src="../../../04-javascript/chatbot.js"></script>
<script type="module" src="../../../04-javascript/script.js"></script>




<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<script src="../../../../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>